<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>EnrollmentDaoImpl.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">enrollment-service</a> &gt; <a href="index.source.html" class="el_package">com.keybank.dao</a> &gt; <span class="el_source">EnrollmentDaoImpl.java</span></div><h1>EnrollmentDaoImpl.java</h1><pre class="source lang-java linenums">/**@Copyright 2022 keybank pvt ltd.
 * All rights are reserved,you should 
*disclose the information outside
* otherwise terms and condition will apply
 */
package com.keybank.dao;

import java.sql.Types;
import java.util.HashMap;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.jdbc.core.SqlOutParameter;
import org.springframework.jdbc.core.SqlParameter;
import org.springframework.jdbc.object.StoredProcedure;
import org.springframework.stereotype.Component;

import com.keybank.exception.BusinessException;
import com.keybank.exception.SystemException;
import com.keybank.model.EnrollmentDaoRequest;
import com.keybank.model.EnrollmentDaoResponse;

/**
 * @author YNBR 14-Mar-2022
 *
 */
@Component
public class EnrollmentDaoImpl extends StoredProcedure implements EnrollmentDao {
	
	@Autowired
	public EnrollmentDaoImpl(JdbcTemplate jdbcTemplate) {
		//register storage name ,input,out params
<span class="nc" id="L34">		super(jdbcTemplate,&quot;AUTO_BILL_PAYMTS_01&quot;);</span>
<span class="nc" id="L35">		registerParams();</span>
<span class="nc" id="L36">	}</span>

	/**
	 * 
	 */
	private void registerParams() {
		//register in params
<span class="nc" id="L43">		declareParameter(new SqlParameter(&quot;CLIENT_ID_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L44">		declareParameter(new SqlParameter(&quot;CARD_NUM_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L45">		declareParameter(new SqlParameter(&quot;CVV_NUM_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L46">		declareParameter(new SqlParameter(&quot;NAME_ON_CARD_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L47">		declareParameter(new SqlParameter(&quot;EXPDATE_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L48">		declareParameter(new SqlParameter(&quot;MOBILENUM_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L49">		declareParameter(new SqlParameter(&quot;BILL_GEN_DATE_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L50">		declareParameter(new SqlParameter(&quot;BILL_PAYMT_DATE_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L51">		declareParameter(new SqlParameter(&quot;AMOUNT_IN&quot;,Types.VARCHAR));</span>
<span class="nc" id="L52">		declareParameter(new SqlParameter(&quot;PROVIDER_IN&quot;,Types.VARCHAR));</span>
		//register out params
<span class="nc" id="L54">		declareParameter(new SqlOutParameter(&quot;RESP_CODE_OUT&quot;,Types.VARCHAR));</span>
<span class="nc" id="L55">		declareParameter(new SqlOutParameter(&quot;RESP_MESSAGE_OUT&quot;,Types.VARCHAR));</span>
<span class="nc" id="L56">		declareParameter(new SqlOutParameter(&quot;ACK_NUM_OUT&quot;,Types.VARCHAR));</span>
		
<span class="nc" id="L58">		compile();</span>
<span class="nc" id="L59">	}</span>

	@Override
	public EnrollmentDaoResponse enrollment(EnrollmentDaoRequest daorequest) throws BusinessException, SystemException{
<span class="nc" id="L63">		System.out.println(&quot;---Enter into DAO Layer  Enrollment--------&quot;);</span>
		// TODO Auto-generated method stub stub
		
		
<span class="nc" id="L67">		EnrollmentDaoResponse enrollmentDaoResponse=new EnrollmentDaoResponse();</span>
		try {
<span class="nc" id="L69">			Map&lt;String, Object&gt; inParams=new HashMap&lt;String, Object&gt;();</span>
<span class="nc" id="L70">			inParams.put(&quot;CLIENT_ID_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L71">			inParams.put(&quot;CARD_NUM_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L72">			inParams.put(&quot;CVV_NUM_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L73">			inParams.put(&quot;NAME_ON_CARD_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L74">			inParams.put(&quot;EXPDATE_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L75">			inParams.put(&quot;MOBILENUM_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L76">			inParams.put(&quot;BILL_GEN_DATE_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L77">			inParams.put(&quot;BILL_PAYMT_DATE_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L78">			inParams.put(&quot;AMOUNT_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L79">			inParams.put(&quot;PROVIDER_IN&quot;, daorequest.getClientId());</span>
<span class="nc" id="L80">			Map&lt;String, Object&gt; outParams=super.execute(inParams);</span>
<span class="nc" id="L81">			String dbRespcode=outParams.get(&quot;RESP_CODE_OUT&quot;).toString();</span>
<span class="nc" id="L82">			String dbRespMsg=outParams.get(&quot;RESP_MESSAGE_OUT&quot;).toString();</span>
<span class="nc" id="L83">			String  ackNo=null;</span>
<span class="nc bnc" id="L84" title="All 2 branches missed.">			if(outParams.get(&quot;RESP_CODE_OUT&quot;)!=null) {</span>
<span class="nc" id="L85">				ackNo=outParams.get(&quot;RESP_CODE_OUT&quot;).toString();</span>
			}
<span class="nc" id="L87">			System.out.println(&quot;--------------ackNo-------&quot;+ackNo);</span>
<span class="nc" id="L88">			System.out.println(&quot;--------------dbRespcode-------&quot;+dbRespcode);</span>
<span class="nc" id="L89">			System.out.println(&quot;--------------dbRespMsg-------&quot;+dbRespMsg);</span>
<span class="nc" id="L90">			 enrollmentDaoResponse=new EnrollmentDaoResponse();</span>
<span class="nc bnc" id="L91" title="All 2 branches missed.">				if(&quot;0&quot;.equals(dbRespcode)) {</span>
					//TODO: convert database resp  to Dao Response
<span class="nc" id="L93">					enrollmentDaoResponse.setEnrollmentStatus(&quot;SUCCESS&quot;);</span>
<span class="nc" id="L94">					enrollmentDaoResponse.setRespCode(&quot;0&quot;);</span>
<span class="nc" id="L95">					enrollmentDaoResponse.setRespMsg(&quot;Erollment Done&quot;);</span>
<span class="nc" id="L96">					System.out.println(&quot;---Exit into DAO Layer----Enrollment&quot;);</span>
					
				}
<span class="nc bnc" id="L99" title="All 6 branches missed.">				else if(&quot;100&quot;.equals(dbRespcode)||&quot;101&quot;.equals(dbRespcode)||&quot;102&quot;.equals(dbRespcode)) {</span>
<span class="nc" id="L100">					throw new BusinessException(dbRespcode,dbRespMsg);</span>
				}
				else {
<span class="nc" id="L103">					throw new SystemException(dbRespcode,dbRespMsg);</span>
				}
		}
<span class="nc" id="L106">		catch(BusinessException e) {</span>
<span class="nc" id="L107">			throw e;</span>
		}
<span class="nc" id="L109">		catch(SystemException ee) {</span>
<span class="nc" id="L110">			throw ee;</span>
<span class="nc" id="L111">		}</span>
<span class="nc" id="L112">		return enrollmentDaoResponse;</span>
		
		
		

		
		
	}

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>